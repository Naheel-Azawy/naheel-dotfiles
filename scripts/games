#!/usr/bin/env jsh

dir     = `/mnt/hdd1/Public/Games`
dir_gb  = `${dir}/gameboy`
dir_n64 = `${dir}/n64`
dir_psx = `${dir}/psx`
dir_win = `${dir}/windows`

gbc = (name)    => `mgba-qt "${dir_gb}/${name}"`
n64 = (name)    => `mupen64plus "${dir_n64}/${name}"`
psx = (name)    => `mednafen "${dir_psx}/${name}"`
win = (d, name) => `winejail win-games-${d} "${dir_win}/${d}" "${name}"`
tui = (name)    => `theterm "${name}"`

games = {
    "supermario":      gbc("Super Mario Bros. Deluxe (USA, Europe).gbc"),
    "supermario64":    n64("Super Mario 64 (U) [!].z64"),
    "mariokart":       gbc("Mario Kart Super Circuit (U) [!].gba"),
    "donkykong":       gbc("1521 - Classic Nes - Donkey Kong (U)(Hyperion).gba"),
    "megaman5":        gbc("Mega Man 5 (U) [S][!].gb"),
    "megaman-x5":      psx("megaman_x5/Megaman X5.cue"),
    "pacman":          gbc("Ms. Pac-Man - Special Color Edition (USA).gbc"),
    "pokemon-crystal": gbc("Pokemon - Crystal Version (USA, Europe).gbc"),
    "spider":          win("solitaire_xp", "spider.exe"),
    "pinball":         win("solitaire_xp", "Pinball/PINBALL.EXE"),
    "tekken3":         psx("Tekken 3/Tekken 3.cue"),
    "pepsiman":        psx("pepsiman/Pepsiman (Japan).cue"),
    "gnome-chess":     "gnome-chess",
    "invaders":        tui("invaders"),
    "nudoku":          tui("nudoku"),
    "tetris":          tui("tetris"),
    "snake":           tui("snake")
}

switch ($1) {
case undefined:
    $`games $(games list | menu-interface -l 20)`
    break
case "list":
    for (let g in games) echo(g)
    break
default:
    let cmd = games[$1]
    if (cmd) {
        echo(cmd)
        exec(cmd)
    } else {
        echo(`Unknown game '${$1}'`)
        exit(1)
    }
}
